USE DBMedico;


CREATE VIEW VwPacienteComMedico 
AS

SELECT P.NOME_PACIENTE AS NOME_PACIENTE,
	   P.END_PAC AS ENDERECO_PACIENTE,
	   P.CEP_PAC AS CEP_PAC,
	   P.CIDADE_PAC AS CIDADE_PACIENTE,
	   E.SIGLA_ESTADO AS UF,
	   EC.NOME_ESTADO_CIVIL AS ESTADO_CIVIL,
	   D.NOME_MEDICO AS NOME_MEDICO,
	   D.ESPECIALIDADE AS ESPECIALIDADE,
	   D.CRM AS CRM,
	   DP.NOME_DEPARTAMENTO AS DEP_DO_MEDICO,
	   P.INSERT_DATETIME AS DATA_CADASTRO_PACIENTE

FROM PACIENTES P
INNER JOIN DOUTORES D			ON D.ID_MEDICO = P.ID_MEDICO
INNER JOIN DEPARTAMENTO DP		ON DP.ID_DEPARTAMENTO = D.ID_DEPARTAMENTO
INNER JOIN ESTADOS E			ON E.ID_ESTADO = P.ID_ESTADO_PAC
INNER JOIN ESTADO_CIVIL EC		ON EC.ID_ESTADO_CIVIL = P.ID_ESTADO_CIVIL_PAC;

-------- PARA SELECIONAR A VIEW
SELECT * FROM VwPacienteComMedico;

----- PARA DROPAR A VIEW

DROP VIEW VwPacienteComMedico;
